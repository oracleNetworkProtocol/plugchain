(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{467:function(t,e,s){"use strict";s.r(e);var a=s(15),n=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"订阅"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#订阅"}},[t._v("#")]),t._v(" 订阅")]),t._v(" "),e("p",[e("code",[t._v("Event")]),t._v("s 是包含有关应用程序执行信息的对象。他们是主要由区块浏览器和钱包等服务提供商用于跟踪各种执行情况消息和索引事务。")]),t._v(" "),e("h2",{attrs:{id:"先决条件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#先决条件"}},[t._v("#")]),t._v(" 先决条件")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://docs.cosmos.network/master/core/events.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cosmos SDK Events"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://geth.ethereum.org/docs/rpc/pubsub",target:"_blank",rel:"noopener noreferrer"}},[t._v("Ethereum's PubSub JSON-RPC API"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"sdk-和-tendermint-事件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sdk-和-tendermint-事件"}},[t._v("#")]),t._v(" SDK 和 Tendermint 事件")]),t._v(" "),e("p",[t._v("可以通过 Tendermint 的 "),e("a",{attrs:{href:"https://tendermint.com/docs/app-dev/subscribing-to-events-via-websocket.html#subscribing-to-events-via-websocket",target:"_blank",rel:"noopener noreferrer"}},[t._v("Websocket"),e("OutboundLink")],1),t._v(" 订阅"),e("code",[t._v("events")]),t._v(" ）。\n这是通过 Websocket 调用 "),e("code",[t._v("subscribe")]),t._v(" RPC 方法来完成的：")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"jsonrpc"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.0"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"method"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"subscribe"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"params"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"query"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"tm.event='eventCategory' AND eventType.eventAttribute='attributeValue'\"")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("您可以订阅的主要 "),e("code",[t._v("eventCategory")]),t._v(" 是：")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("NewBlock")]),t._v("：包含在"),e("code",[t._v("BeginBlock")]),t._v("和"),e("code",[t._v("EndBlock")]),t._v("期间触发的"),e("code",[t._v("events")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("Tx")]),t._v("：包含在"),e("code",[t._v("DeliverTx")]),t._v("（即事务处理）期间触发的"),e("code",[t._v("events")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("ValidatorSetUpdates")]),t._v("：包含块的验证器集更新。")])]),t._v(" "),e("p",[t._v("这些事件是在提交块后从"),e("code",[t._v("state")]),t._v("包中触发的。你可以获得完整的"),e("code",[t._v("events")]),t._v("类别列表。[这里]（https://godoc.org/github.com/tendermint/tendermint/types#pkg-constants）。")]),t._v(" "),e("p",[e("code",[t._v("query")]),t._v(" 的 "),e("code",[t._v("type")]),t._v(" 和 "),e("code",[t._v("attribute")]),t._v(" 值允许您过滤您所在的特定 "),e("code",[t._v("event")]),t._v("\n寻找。例如，"),e("code",[t._v("MsgEthereumTx")]),t._v("交易会触发"),e("code",[t._v("ethermint")]),t._v("类型的"),e("code",[t._v("event")]),t._v("，并且\n具有"),e("code",[t._v("sender")]),t._v("和"),e("code",[t._v("recipient")]),t._v("作为"),e("code",[t._v("attributes")]),t._v("。订阅此"),e("code",[t._v("event")]),t._v("将按如下方式完成：")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"jsonrpc"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.0"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"method"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"subscribe"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"params"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"query"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"tm.event='Tx' AND ethereum.recipient='hexAddress'\"")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("其中“hexAddress”是一个EIP-55地址（例如：“0x1122334455667788990011223344556677889900”）。")]),t._v(" "),e("h3",{attrs:{id:"tendermint-websocket"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tendermint-websocket"}},[t._v("#")]),t._v(" Tendermint Websocket")]),t._v(" "),e("p",[t._v("要开始与 Tendermint websocket 的连接，您需要使用 "),e("code",[t._v("--rpc.laddr")]),t._v(" 定义地址\n启动节点时的标志（默认"),e("code",[t._v("tcp://127.0.0.1:26657")]),t._v("）：")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("plugchaind start "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--rpc.laddr")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tcp://127.0.0.1:26657"')]),t._v("\n")])])]),e("p",[t._v("然后，使用 "),e("a",{attrs:{href:"https://github.com/hashrocket/ws",target:"_blank",rel:"noopener noreferrer"}},[t._v("ws"),e("OutboundLink")],1),t._v(" 开始一个 websocket 订阅")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# connect to tendermint websocket at port 8080 as defined above")]),t._v("\nws ws://localhost:8080/websocket\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# subscribe to new Tendermint block headers")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jsonrpc"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.0"')]),t._v(", "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"method"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"subscribe"')]),t._v(", "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"params"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"tm.event='NewBlockHeader'\"")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"tendermint-事件列表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tendermint-事件列表"}},[t._v("#")]),t._v(" Tendermint 事件列表")]),t._v(" "),e("p",[t._v("您可以订阅的主要事件是：")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("NewBlock")]),t._v("：包含在"),e("code",[t._v("BeginBlock")]),t._v("和"),e("code",[t._v("EndBlock")]),t._v("期间触发的"),e("code",[t._v("events")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("Tx")]),t._v("：包含在"),e("code",[t._v("DeliverTx")]),t._v("（即事务处理）期间触发的"),e("code",[t._v("events")]),t._v("。")]),t._v(" "),e("li",[e("code",[t._v("ValidatorSetUpdates")]),t._v("：包含块的验证器集更新。")])]),t._v(" "),e("p",[t._v("所有 Tendermint 事件键的列表：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th"),t._v(" "),e("th",[t._v("活动类型")]),t._v(" "),e("th",[t._v("分类")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("订阅特定事件")]),t._v(" "),e("td",[e("code",[t._v('"tm.event"')])]),t._v(" "),e("td",[e("code",[t._v("块")])])]),t._v(" "),e("tr",[e("td",[t._v("订阅特定交易")]),t._v(" "),e("td",[e("code",[t._v('"tx.hash"')])]),t._v(" "),e("td",[e("code",[t._v("块")])])]),t._v(" "),e("tr",[e("td",[t._v("订阅特定区块高度的交易")]),t._v(" "),e("td",[e("code",[t._v('"tx.height"')])]),t._v(" "),e("td",[e("code",[t._v("块")])])]),t._v(" "),e("tr",[e("td",[t._v("索引 "),e("code",[t._v("BeginBlock")]),t._v(" 和 "),e("code",[t._v("Endblock")]),t._v(" 事件")]),t._v(" "),e("td",[e("code",[t._v('"block.height"')])]),t._v(" "),e("td",[e("code",[t._v("块")])])]),t._v(" "),e("tr",[e("td",[t._v("订阅 ABCI "),e("code",[t._v("BeginBlock")]),t._v(" 事件")]),t._v(" "),e("td",[e("code",[t._v('"begin_block"')])]),t._v(" "),e("td",[e("code",[t._v("块")])])]),t._v(" "),e("tr",[e("td",[t._v("订阅 ABCI "),e("code",[t._v("EndBlock")]),t._v(" 事件")]),t._v(" "),e("td",[e("code",[t._v('"end_block"')])]),t._v(" "),e("td",[e("code",[t._v("共识")])])])])]),t._v(" "),e("p",[t._v("以下是可用于订阅 "),e("code",[t._v("tm.event")]),t._v(" 类型的值列表：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th"),t._v(" "),e("th",[t._v("事件价值")]),t._v(" "),e("th",[t._v("分类")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("新区块")]),t._v(" "),e("td",[e("code",[t._v('"NewBlock"')])]),t._v(" "),e("td",[e("code",[t._v("block")])])]),t._v(" "),e("tr",[e("td",[t._v("新区块头")]),t._v(" "),e("td",[e("code",[t._v('"NewBlockHeader"')])]),t._v(" "),e("td",[e("code",[t._v("block")])])]),t._v(" "),e("tr",[e("td",[t._v("新拜占庭证据")]),t._v(" "),e("td",[e("code",[t._v('"NewEvidence"')])]),t._v(" "),e("td",[e("code",[t._v("block")])])]),t._v(" "),e("tr",[e("td",[t._v("新交易")]),t._v(" "),e("td",[e("code",[t._v('"Tx"')])]),t._v(" "),e("td",[e("code",[t._v("block")])])]),t._v(" "),e("tr",[e("td",[t._v("验证器集已更新")]),t._v(" "),e("td",[e("code",[t._v('"ValidatorSetUpdates"')])]),t._v(" "),e("td",[e("code",[t._v("block")])])]),t._v(" "),e("tr",[e("td",[t._v("块同步状态")]),t._v(" "),e("td",[e("code",[t._v('"BlockSyncStatus"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])]),t._v(" "),e("tr",[e("td",[t._v("锁")]),t._v(" "),e("td",[e("code",[t._v('"Lock"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])]),t._v(" "),e("tr",[e("td",[t._v("新一轮共识")]),t._v(" "),e("td",[e("code",[t._v('"NewRound"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])]),t._v(" "),e("tr",[e("td",[t._v("波尔卡")]),t._v(" "),e("td",[e("code",[t._v('"Polka"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])]),t._v(" "),e("tr",[e("td",[t._v("重新锁定")]),t._v(" "),e("td",[e("code",[t._v('"Relock"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])]),t._v(" "),e("tr",[e("td",[t._v("状态同步状态")]),t._v(" "),e("td",[e("code",[t._v('"StateSyncStatus"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])]),t._v(" "),e("tr",[e("td",[t._v("超时建议")]),t._v(" "),e("td",[e("code",[t._v('"TimeoutPropose"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])]),t._v(" "),e("tr",[e("td",[t._v("超时等待")]),t._v(" "),e("td",[e("code",[t._v('"TimeoutWait"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])]),t._v(" "),e("tr",[e("td",[t._v("解锁")]),t._v(" "),e("td",[e("code",[t._v('"Unlock"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])]),t._v(" "),e("tr",[e("td",[t._v("块有效")]),t._v(" "),e("td",[e("code",[t._v('"ValidBlock"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])]),t._v(" "),e("tr",[e("td",[t._v("共识投票")]),t._v(" "),e("td",[e("code",[t._v('"Vote"')])]),t._v(" "),e("td",[e("code",[t._v("consensus")])])])])]),t._v(" "),e("h2",{attrs:{id:"ethereum-json-rpc-events"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ethereum-json-rpc-events"}},[t._v("#")]),t._v(" Ethereum JSON-RPC Events")]),t._v(" "),e("p",[t._v("Plug Chain 还支持 Ethereum "),e("a",{attrs:{href:"https://eth.wiki/json-rpc/API",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSON-RPC"),e("OutboundLink")],1),t._v(" 过滤器调用订阅 "),e("a",{attrs:{href:"https://eth.wiki/json-rpc/API#eth_newfilter",target:"_blank",rel:"noopener noreferrer"}},[t._v("状态日志"),e("OutboundLink")],1),t._v(","),e("a",{attrs:{href:"https://eth.wiki/json-rpc/API#eth_newblockfilter",target:"_blank",rel:"noopener noreferrer"}},[t._v("区块"),e("OutboundLink")],1),t._v(" 或 [待定交易]（https://eth.wiki/json-rpc/API#eth_newpendingtransactionfilter）更改。")]),t._v(" "),e("p",[t._v("在底层，它使用 Tendermint RPC 客户端的事件系统来处理订阅\n然后格式化为与以太坊兼容的事件。")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v(" POST "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--data")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"jsonrpc":"2.0","method":"eth_newBlockFilter","params":[],"id":1}\'')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-H")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type: application/json"')]),t._v(" http://localhost:8545\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jsonrpc"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.0"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),t._v(":1,"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x3503de5f0c766c68f78a03a3b05036a5"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("然后您可以使用 "),e("a",{attrs:{href:"https://eth.wiki/json-rpc/API#eth_getfilterchanges",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("eth_getFilterChanges")]),e("OutboundLink")],1),t._v(" 调用检查状态是否发生变化：")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v(" POST "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--data")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"jsonrpc":"2.0","method":"eth_getFilterChanges","params":["0x3503de5f0c766c68f78a03a3b05036a5"],"id":1}\'')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-H")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type: application/json"')]),t._v(" http://localhost:8545\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jsonrpc"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.0"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),t._v(":1,"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"result"')]),t._v(":"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x7d44dceff05d5963b5bc81df7e9f79b27e777b0a03a6feca09f3447b99c6fa71"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x3961e4050c27ce0145d375255b3cb829a5b4e795ac475c05a219b3733723d376"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0xd7a497f95167d63e6feca70f344d9f6e843d097b62729b8f43bdcd5febf142ab"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x55d80a4ba6ef54f2a8c0b99589d017b810ed13a1fda6a111e1b87725bc8ceb0e"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x9e8b92c17280dd05f2562af6eea3285181c562ebf41fc758527d4c30364bcbc4"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x7353a4b9d6b35c9eafeccaf9722dd293c46ae2ffd4093b2367165c3620a0c7c9"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x026d91bda61c8789c59632c349b38fd7e7557e6b598b94879654a644cfa75f30"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x73e3245d4ddc3bba48fa67633f9993c6e11728a36401fa1206437f8be94ef1d3"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"ethereum-websocket"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ethereum-websocket"}},[t._v("#")]),t._v(" Ethereum Websocket")]),t._v(" "),e("p",[t._v("由于 Plug Chain 运行使用 Tendermint Core 作为它的共识引擎，并且它是使用 Cosmos 构建的\nSDK 框架，它继承了它们的事件格式。但是为了支持原生的Web3\n"),e("a",{attrs:{href:"https://geth.ethereum.org/docs/rpc/pubsub",target:"_blank",rel:"noopener noreferrer"}},[t._v("Ethereum's websockets的兼容性\nPubSubAPI"),e("OutboundLink")],1),t._v("，Plug Chain 需要转换 Tendermint\n检索到以太坊类型的响应。")]),t._v(" "),e("p",[t._v("您可以在启动时使用 "),e("code",[t._v("--json-rpc.ws-address")]),t._v(" 标志启动与以太坊 websocket 的连接\n节点（默认“0.0.0.0:8546”）：")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("plugchaind start  --json-rpc.address"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.0.0.0:8545"')]),t._v(" --json-rpc.ws-address"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.0.0.0:8546"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--evm.rpc.api")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eth,web3,net,txpool,debug"')]),t._v(" --json-rpc.enable\n")])])]),e("p",[t._v("然后，使用 "),e("a",{attrs:{href:"https://github.com/hashrocket/ws",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("ws")]),e("OutboundLink")],1),t._v(" 开始一个 websocket 订阅")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# connect to tendermint websocet at port 8546 as defined above")]),t._v("\nws ws://localhost:8546/\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# subscribe to new Ethereum-formatted block Headers")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"method"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eth_subscribe"')]),t._v(", "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"params"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"newHeads"')]),t._v(", "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jsonrpc"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.0"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0x44e010cb2c3161e9c02207ff172166ef"')]),t._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),t._v(":1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);